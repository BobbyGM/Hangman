<!--
Spânzurătoare
Se introduce un cuvânt. Să se implementeze ghicirea lui conform regulilor jocului.
-->
<!doctype html>
<html lang="en">
  <head>
    <title>Hangman</title>
  </head>
  <body>
	<h1 style="text-align: center">Hangman</h1>
	<div align="center">
		<button onclick="addLettersCells()">Start Game</button>
		<div id=letters>
		<br>
		</div>
	</div>
	<script>
	// we enter the word to be found
	var word = window.prompt("Please enter the word to be found.\nObservation: The word must have minimum 2 letters.");
	// we make sure that a word is entered
	while (word.length < 2 || !word.match(/^[a-z]+$/i)) {
		word = window.prompt("Please enter the word to be found.\nObservation: The word must have minimum 2 letters.");
	}
	// we enter the number of tries
	var numTries = Number(window.prompt("Please enter the number of tries for finding the word.\nObservation: The number of tries >= word's number of letters."));
	// we make sure that a number is entered
	while (numTries < word.length || isNaN(numTries)) {
			numTries = Number(window.prompt("Please enter the number of tries for finding the word.\nObservation: The number of tries >= word's number of letters."));
	}
	function addLettersCells() {
		// we add "word.length" empty text cells in which will be displayed the letters found
		addParagraph("Letters of the word to be found:");
		for (let i = 1; i <= word.length; ++i) {
			let cell = document.createElement("input");
			letters.append(cell);
			cell.id = i;
			cell.setAttribute("readonly","readonly");
			cell.setAttribute("size","1");
			cell.style.textAlign = "center";
		}
		addLineBreak();
		addLineBreak();
		// we add text box for entering the chosen letter
		addParagraph("Enter letter to be checked:");
		let checkLetter = document.createElement("input");
		letters.append(checkLetter);
		checkLetter.id = word.length + 1;
		checkLetter.setAttribute("size","1");
		checkLetter.setAttribute("maxlength", "1");
		checkLetter.style.textAlign = "center";
		addLineBreak();
		addLineBreak();
		// we add a button used for the checking process of the letter entered
		let buttonCheck = document.createElement("button");
		letters.append(buttonCheck);
		buttonCheck.textContent = "Check";
		buttonCheck.setAttribute("onclick","findLetter()");
		alert("Be careful!!!\nYou have " + numTries + " tries to find the word.");
	}
	var numLetters = word.length;
	var countEnteredLetters = 0;
	var countTries = numTries;
	function findLetter() {
		// we verify each letter read if exists in the word to be found
		let checkLetterId = document.getElementById(word.length + 1);
		let foundLetter = 0;
		// we check if a letter was entered
		if (checkLetterId.value.length == 1 && checkLetterId.value.match(/^[a-z]+$/i)) {
			++countEnteredLetters;
			// after the first letter is entered we add a text box for storing the entered letters
			if (countEnteredLetters == 1) {
				addParagraph("Entered letters:");
				let enteredLetters = document.createElement("input");
				letters.append(enteredLetters);
				enteredLetters.id = "checkedLet";
				enteredLetters.setAttribute("readonly","readonly");
				enteredLetters.setAttribute("size","20");
				enteredLetters.style.textAlign = "center";
				enteredLetters.setAttribute("value"," ");
			}
			for (let i = 0; i < word.length; ++i) {
				let input = document.getElementById(i + 1);
				if (checkLetterId.value == word[i]) {
					foundLetter = 1;
					input.value = checkLetterId.value;
					--numLetters;
				}
			}
			// we display a message depending if the letter was found or not
			if (foundLetter == 1) {
				alert("Correct!");
			} else {
				alert("Wrong!");
			}
			//	we add the entered letter to the array of entered letters
			if (countEnteredLetters == numTries || numLetters == 0) {
				checkedLet.value += checkLetterId.value;
			} else {
				checkedLet.value += checkLetterId.value + ",";
			}
			// we reinitialize the value of checkLetterId with ""
			checkLetterId.value = "";
			// we verify if the word was found or not
			// we count how many tries have left
			if (numLetters == 0) {
				alert("Congratulations!!! You've found the word :)\nIt is: " + word);
				newGame();
			} else {
				--countTries;
				if (countTries > 0) {
					alert("You have " + countTries + " try(s) left.");
				} else {
					alert("Unfortunately you haven't found the word :(\nIt is: " + word + "\nGood luck next time!");
					newGame();
				}
			}
		} else {
			alert("Please enter a letter.");
			checkLetterId.value = "";
		}
	}
	function newGame(){
		addLineBreak();
		addLineBreak();
		// we add a button for starting a new game
		// we are refreshing the page
		let buttonNewGame = document.createElement("button");
		letters.append(buttonNewGame);
		buttonNewGame.textContent = "New Game";
		buttonNewGame.setAttribute("onclick","window.location.reload()");
	}
	function addLineBreak(){
		let newLine = document.createElement("br");
		letters.append(newLine);
	}
	function addParagraph(paragraphContent){
		let paragraph = document.createElement("p");
		letters.append(paragraph);
		paragraph.textContent = paragraphContent;
	}
	</script>
</html>
